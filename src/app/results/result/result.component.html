<mat-tab-group>
  <mat-tab label="All tests">

    <div class="container">
      <table mat-table
        [dataSource]="dataSource"
        matSort
        class="mat-elevation-z8">

        <ng-container matColumnDef="id">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> ID </th>
          <td mat-cell
            *matCellDef="let result">{{result.id}}</td>
        </ng-container>

        <ng-container matColumnDef="testname">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> Test name </th>
          <td mat-cell
            *matCellDef="let result">{{result.Test.name}}</td>
        </ng-container>

        <ng-container matColumnDef="student">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> Student </th>
          <td mat-cell
            *matCellDef="let result">{{result.User.firstName}} {{result.User.lastName}}</td>
        </ng-container>

        <ng-container matColumnDef="creator">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> Creator </th>
          <td mat-cell
            *matCellDef="let result"> {{result.Test.userId}}</td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> Status </th>
          <td mat-cell
            *matCellDef="let result"> {{result.status}} </td>
        </ng-container>

        <ng-container matColumnDef="result">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> Result </th>
          <td mat-cell
            *matCellDef="let result">{{ result.percent }}%</td>
        </ng-container>

        <ng-container matColumnDef="start">
          <th mat-header-cell
            *matHeaderCellDef
            mat-sort-header> </th>
          <td mat-cell
            *matCellDef="let result"> <button *ngIf="result.status != resultClosed"
              [routerLink]="'/users/' + currentUser.id + '/results/' + result.id"
              mat-flat-button
              color="primary">Start</button>
          </td>
        </ng-container>

        <ng-container matColumnDef="edit">
          <th mat-header-cell
            *matHeaderCellDef> </th>
          <td mat-cell
            *matCellDef="let result">

          </td>
        </ng-container>


        <tr mat-header-row
          *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row
          *matRowDef="let row; columns: displayedColumns;"></tr>

      </table>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]"
        showFirstLastButtons></mat-paginator>

    </div>
  </mat-tab>
  <mat-tab label="By Test">

      <mat-expansion-panel *ngFor="let test of tests">
          <mat-expansion-panel-header>
            <mat-panel-title>
              {{ test.id }}
            </mat-panel-title>
            <mat-panel-description>
              {{ test.name }} | {{test.User.Group.name}}
            </mat-panel-description>
          </mat-expansion-panel-header>
        
          <h2>Creator name: <u>{{test.User.firstName}} {{test.User.lastName}}</u></h2>

          <ul>
            <li *ngFor="let result of getTestsResults(test)">
                {{result.User.firstName}} {{result.User.lastName}}
            </li>
          </ul>
        
        </mat-expansion-panel>

  </mat-tab>
  <mat-tab label="Templates">
    <app-test></app-test>
  </mat-tab>
</mat-tab-group>
